/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
((Drupal,once)=>{Drupal.behaviors.cmu_base={attach:(context,settings)=>{const _this=this;const tables=context.querySelectorAll('.Table__stack table');tables.forEach((table)=>{let rows=table.querySelectorAll('tr:not(thead tr)');let headerRow=table.querySelector('thead tr');let headerCells;if(headerRow)headerCells=headerRow.querySelectorAll('th');else{if(rows[0].querySelector('th')){let newTable=context.createElement('table');let newTableHead=context.createElement('thead');let newTableHeadRow=context.createElement('tr');let newTableBody=context.createElement('tbody');newTableHead.appendChild(newTableHeadRow);newTable.appendChild(newTableHead);newTable.appendChild(newTableBody);rows.forEach((row,index)=>{newTableHeadRow.appendChild(row.querySelector('th').cloneNode(true));let newTableCells=row.querySelectorAll('td');newTableCells.forEach((cell,cellIndex)=>{let newTableRow;if(index===0){newTableRow=context.createElement('tr');newTableBody.appendChild(newTableRow);}else newTableRow=newTableBody.querySelectorAll(`tr`)[cellIndex];table.classList.add('Table__stack--desktop');newTable.classList.add('Table__stack--mobile');newTableRow.appendChild(cell.cloneNode(true));});});table.parentElement.appendChild(newTable);headerCells=newTableHeadRow.querySelectorAll('th');rows=newTableBody.querySelectorAll('tr');}}rows.forEach((row,index)=>{let cells=row.querySelectorAll('th, td');headerCells&&cells.forEach((cell,index)=>{cell.setAttribute('data-label',headerCells[index].textContent.trim());});});});const getColumnCount=(layout,isTertiary)=>{switch(layout){case 'default':return isTertiary?2:3;case 'compact':return isTertiary?3:4;case 'horizontal':return isTertiary?1:2;default:return isTertiary?2:3;}};const getRowCount=(rowClass,totalRows)=>{switch(rowClass){case '1_row':return 1;case '3_rows':return 3;case '6_rows':return 6;case 'display_all':return totalRows;default:return 3;}};const bioLists=once('BioList','.BioList',context);bioLists.forEach((bioList)=>{let isTertiary=context.body.classList.contains('page-node-type-tertiary');let bioCards=bioList.querySelectorAll('.BioCard');let columnCount=getColumnCount(bioList.getAttribute('data-layout'),isTertiary);let rowCount=getRowCount(bioList.getAttribute('data-rows'),Math.ceil(bioCards.length/columnCount));let bioCount;let spanVisible=bioList.querySelector('.BioList__visible');let loadMore=bioList.querySelector('.BioList__load-more');let loadMoreButton=bioList.querySelector('.BioList__load-more .load-more-bios');let load=(e)=>{bioCount=e?bioCount+(6*columnCount):rowCount*columnCount;bioCards.forEach((bioCard,index)=>{index<bioCount&&bioCard.classList.add('show');});spanVisible&&(spanVisible.textContent=Math.min(bioCount,bioCards.length));loadMore&&bioCount>=bioCards.length&&loadMore.remove();};loadMoreButton&&loadMoreButton.addEventListener('click',load);load();});const newsLoadMore=once('NewsLoadMore','.load-more',context);newsLoadMore.forEach((loadMoreButton)=>{let postsWrapper=loadMoreButton.closest('.Posts_wrapper');postsWrapper&&loadMoreButton.addEventListener('click',(e)=>{let hiddenItems=postsWrapper.querySelectorAll('.load-items .Page__item:not(.show)');hiddenItems.forEach((item,index)=>{index<6&&item.classList.add('show');});hiddenItems.length<=6&&loadMoreButton.classList.add('hide');});});const checkLists=once('CheckList','.CheckList .CheckList__grid .CheckList__heading:nth-of-type(1) .CheckList__toggle',context);checkLists.forEach((checkList)=>{checkList.setAttribute('aria-expanded','true');});window.addEventListener('load',()=>{const observer=new MutationObserver(()=>{let eventDates=document.querySelectorAll('.cal_date');eventDates.forEach((dateContainer)=>{let monthElement=dateContainer.querySelector(".cal_date_month");let dayElement=dateContainer.querySelector(".cal_date_day");if(monthElement&&dayElement){let monthText=monthElement.innerText.trim();let day=dayElement.innerText.trim();let monthMap={"Jan":1,"Feb":2,"Mar":3,"Apr":4,"May":5,"Jun":6,"Jul":7,"Aug":8,"Sep":9,"Oct":10,"Nov":11,"Dec":12};let month=monthMap[monthText];if(month){let year=new Date().getFullYear();let formattedDate=`${month}/${day}/${year}`;dateContainer.innerHTML=`<span class="formatted_event_date">${formattedDate}</span>`;}}});});let targetNode=document.querySelector('.events-js');if(targetNode)observer.observe(targetNode,{childList:true,subtree:true});let TLDots=context.querySelector('[data-flexscroll-dots]');let TLDotsWrapper=TLDots?TLDots.closest('.flexscroll-area.with-scroll'):false;if(TLDots&&TLDotsWrapper)if(TLDots.offsetHeight>TLDotsWrapper.offsetHeight){TLDotsWrapper.classList.remove('scrolled');TLDotsWrapper.classList.remove('fix-scroll');}else TLDotsWrapper.classList.add('fix-scroll');context.querySelectorAll('.Posts .Posts__item:nth-of-type(-n+6)').forEach((post)=>{post.classList.add('show');});setTimeout(()=>{context.querySelectorAll('.paragraph--type--embed-form iframe, iframe[class*="wufoo-form"]').forEach((iframe)=>{if(iframe.height)iframe.style.height=`${iframe.height}px`;});},1000);});const YTPlayers=once('YTPlayer','#yt-player',context);YTPlayers.forEach((YTPlayer)=>{if(!window.YT){var tag=context.createElement('script');tag.src='https://www.youtube.com/iframe_api';context.body.appendChild(tag);}YTPlayer.classList.add('video-loaded');window.onYouTubeIframeAPIReady=()=>{var videoId=document.getElementById('yt-player').dataset.videoId;window.ytPlayer=new YT.Player('yt-player',{videoId,playerVars:{autoplay:1,controls:0,mute:1,modestbranding:1,rel:0,enablejsapi:1},events:{'onReady':(event)=>{event.target.playVideo();}}});};YTControls=context.getElementById('yt-control');YTControls&&YTControls.addEventListener('click',(e)=>{if(window.ytPlayer){var playerState=window.ytPlayer.getPlayerState();if(playerState===YT.PlayerState.PLAYING){window.ytPlayer.pauseVideo();YTControls.classList.add('Hero__control--paused');}else{window.ytPlayer.playVideo();YTControls.classList.remove('Hero__control--paused');}}});});const CDNControls=once('CDNControls','#cdn-control',context);const CDNVideos=once('CDNVideos','.cdn_video',context);CDNControls.forEach((CDNControl)=>{CDNVideos.forEach((CDNVideo)=>{CDNVideo.click();CDNControls.classList.contains('Hero__control--paused')?CDNControls.classList.remove('Hero__control--paused'):CDNControls.classList.add('Hero__control--paused');});});const automodal=(target,options)=>{const reflow=()=>{document.documentElement.scrollTop;};const animations=(element)=>{return Promise.allSettled(element.getAnimations().map((animation)=>animation.finished));};const getType=(target)=>{const href=target.getAttribute('href');const type=target.getAttribute('data-automodal-type');if(type)return type;if(href.startsWith('#'))return 'id';if(href.includes('youtube.com/shorts/'))return 'short';if(href.includes('youtube.com')||href.includes('youtu.be'))return 'youtube';if(href.includes('tiktok.com'))return 'tiktok';if(href.includes('instagram.com/p/'))return 'instagram';if(href.includes('instagram.com/reel/'))return 'reel';if(href.includes('vimeo.com'))return 'vimeo';if(href.includes('google.com/maps/'))return 'map';if(href.includes('cmu.widen.net'))return 'iframe';return 'image';};const iframe=(src,title)=>{return `<iframe src="${src}" ${title&&`title="${title}"`} allow="autoplay; fullscreen;"></iframe>`;};const load=async(target)=>{const href=target.getAttribute('href');const type=getType(target);const alt=target.getAttribute('data-automodal-alt')??'';const title=target.getAttribute('data-automodal-title')??'';if(type==='fetch')return (await (await fetch(href)).text()).trim();if(type==='iframe')return iframe(href,title);if(type==='id')return document.querySelector(href).outerHTML.trim();if(type==='short'){const id=href.split('/shorts/')[1];const src=`https://www.youtube.com/embed/${id}`;return iframe(src,title);}if(type==='youtube'){let src=`https://www.youtube.com/embed/`;if(href.includes('youtube.com'))src+=href.split('v=')[1].replace('&','?');if(href.includes('youtu.be'))src+=href.split('youtu.be/')[1];return iframe(src,title);}if(type==='tiktok'){const id=href.split('/video/')[1];const src=`https://www.tiktok.com/embed/v2/${id}`;return iframe(src,title);}if(type==='instagram'){const id=href.split('/p/')[1].split('/')[0];const src=`https://www.instagram.com/p/${id}/embed/captioned/`;return iframe(src,title);}if(type==='reel'){const id=href.split('/reel/')[1].split('/')[0];const src=`https://www.instagram.com/reel/${id}/embed/captioned/`;return iframe(src,title);}if(type==='vimeo'){const id=href.split('vimeo.com/')[1];const src=`https://player.vimeo.com/video/${id}`;return iframe(src,title);}if(type==='map'){let src='https://www.google.com/maps/embed/v1/';if(href.includes('/maps/place/')){const place=href.match('(?:/maps/place/)([^/]+)')[1];src+=`place?key=${options.googleMapsAPIKey}&q=${place}`;}if(href.includes('/maps/@')){const data=href.match('(?:/maps/@)([^z]+)')[1].split(',');src+=`view?key=${options.googleMapsAPIKey}&center=${data[0]},${data[1]}&zoom=${data[2]}z`;}return iframe(src,title);}return `<img src="${href}" ${alt&&`alt="${alt}"`}>`;};const item=async(target)=>{const type=getType(target);const name=target.getAttribute('data-automodal-custom')??'';const content=await load(target);const caption=target.getAttribute('data-automodal-caption')??'';return `
            <div class="Automodal__item Automodal__item--${type} ${name&&`Automodal__item--${name}`}">
              <figure class="Automodal__content">
                ${content}
                ${caption&&`<figcaption class="Automodal__caption">${caption}</figcaption>`}
              </figure>
            </div>
          `;};target.addEventListener('click',(e)=>{e.preventDefault();let updating=false;let index;let group=target.getAttribute('data-automodal-group')??'';if(group){group=document.querySelectorAll(`[data-automodal-group="${group}"]`);index=[...group].indexOf(target);}const dialog=document.createElement('dialog');dialog.classList.add('Automodal');dialog.innerHTML=`
            <button class="Automodal__close" aria-label="Close"></button>
            <div class="Automodal__viewport"></div>
            ${group&&`
              <button class="Automodal__nav Automodal__nav--prev" aria-label="Previous"></button>
              <button class="Automodal__nav Automodal__nav--next" aria-label="Next"></button>
            `}
          `;const close=dialog.querySelector('.Automodal__close');const viewport=dialog.querySelector('.Automodal__viewport');const prev=dialog.querySelector('.Automodal__nav--prev');const next=dialog.querySelector('.Automodal__nav--next');const insert=async(target)=>{viewport.insertAdjacentHTML('beforeend',await item(target));target.dispatchEvent(new CustomEvent('load'));};const nav=async(dir)=>{if(group&&!updating){const remove=viewport.firstElementChild;if(dir==='prev')index=index-1>=0?index-1:group.length-1;if(dir==='next')index=index+1<group.length?index+1:0;updating=true;dialog.classList.add(`Automodal--${dir}`);await insert(group[index]);const add=viewport.lastElementChild;add.classList.add('Automodal__item--add');reflow();add.classList.remove('Automodal__item--add');remove.classList.add('Automodal__item--remove');await animations(add);await animations(remove);remove.remove();dialog.classList.remove(`Automodal--${dir}`);updating=false;}};const remove=async()=>{dialog.classList.remove('Automodal--active');await animations(dialog);dialog.close();dialog.remove();};const keydown=(e)=>{if(e.key==='ArrowLeft')nav('prev');if(e.key==='ArrowRight')nav('next');if(e.key==='Escape'){e.preventDefault();remove();}};const build=async()=>{document.body.append(dialog);dialog.showModal();await insert(target);reflow();dialog.classList.add('Automodal--active');};const outside=(e)=>{if(e.target===dialog)remove();};const listen=()=>{dialog.addEventListener('keydown',keydown);dialog.addEventListener('click',outside);prev?.addEventListener('click',()=>{nav('prev');});next?.addEventListener('click',()=>{nav('next');});close.addEventListener('click',remove);};const init=()=>{build();listen();};init();});};const targets$2=once('automodal-init','[data-automodal-custom]',context);for(const target of targets$2)automodal(target);}};})(Drupal,once);;
